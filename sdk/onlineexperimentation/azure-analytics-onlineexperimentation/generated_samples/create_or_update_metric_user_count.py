# pylint: disable=line-too-long,useless-suppression
# coding=utf-8
# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
# Code generated by Microsoft (R) Python Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is regenerated.
# --------------------------------------------------------------------------

from azure.identity import DefaultAzureCredential

from azure.analytics.onlineexperimentation import OnlineExperimentationClient

"""
# PREREQUISITES
    pip install azure-identity
    pip install azure-analytics-onlineexperimentation
# USAGE
    python create_or_update_metric_user_count.py

    Before run the sample, please set the values of the client ID, tenant ID and client secret
    of the AAD application as environment variables: AZURE_CLIENT_ID, AZURE_TENANT_ID,
    AZURE_CLIENT_SECRET. For more info about how to get the value, please see:
    https://docs.microsoft.com/azure/active-directory/develop/howto-create-service-principal-portal
"""


def main():
    client = OnlineExperimentationClient(
        endpoint="ENDPOINT",
        credential=DefaultAzureCredential(),
    )

    response = client.create_or_update_metric(
        experiment_metric_id="users_purchase",
        resource={
            "categories": ["Monetization"],
            "definition": {"event": {"eventName": "Transaction", "filter": "Revenue > 0"}, "type": "UserCount"},
            "description": "The number of users who have made at least one purchase transaction. Refund transactions are excluded from this metric. As the analysis period grows, this metric begins to saturate as users making multiple purchases no longer contribute.",
            "desiredDirection": "Increase",
            "displayName": "Users with purchase",
            "lifecycle": "Active",
        },
    )
    print(response)


# x-ms-original-file: 2025-05-31-preview/CreateOrUpdateMetric_UserCount.json
if __name__ == "__main__":
    main()
